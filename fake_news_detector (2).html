<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Fact Checker - News Verification Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .input-section {
            margin-bottom: 30px;
        }

        .input-tabs {
            display: flex;
            margin-bottom: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            padding: 4px;
        }

        .tab-button {
            flex: 1;
            padding: 12px 20px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #666;
        }

        .tab-button.active {
            background: #667eea;
            color: white;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .textarea-container {
            position: relative;
            margin-bottom: 20px;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 20px;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            font-size: 16px;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s ease;
            background: #fafbfc;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-input {
            display: none;
        }

        .file-label {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            min-height: 150px;
            border: 2px dashed #d1d9e6;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #fafbfc;
            flex-direction: column;
            gap: 10px;
        }

        .file-label:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }

        .file-icon {
            font-size: 3rem;
            color: #667eea;
        }

        .analyze-button {
            width: 100%;
            padding: 16px 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .analyze-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .analyze-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results {
            display: none;
            margin-top: 30px;
        }

        .result-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            border-left: 5px solid #667eea;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .result-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            gap: 10px;
        }

        .status-icon {
            font-size: 1.5rem;
        }

        .fake {
            border-left-color: #ff6b6b;
        }

        .fake .status-icon {
            color: #ff6b6b;
        }

        .real {
            border-left-color: #51cf66;
        }

        .real .status-icon {
            color: #51cf66;
        }

        .uncertain {
            border-left-color: #ffd43b;
        }

        .uncertain .status-icon {
            color: #ffd43b;
        }

        .result-text {
            font-size: 16px;
            line-height: 1.6;
            color: #444;
        }

        .confidence-meter {
            margin-top: 15px;
        }

        .confidence-bar {
            background: #e9ecef;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .uploaded-image {
            max-width: 100%;
            max-height: 200px;
            border-radius: 8px;
            margin: 10px 0;
            object-fit: contain;
        }

        .api-config {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .api-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .api-note {
            font-size: 12px;
            color: #666;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 16px;
            }
            
            .content {
                padding: 20px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç AI Fact Checker</h1>
            <p>Verify news authenticity with advanced AI analysis</p>
        </div>

        <div class="content">
            <div class="api-config">
                <h3>API Configuration</h3>
                <input type="password" id="geminiApiKey" class="api-input" placeholder="Enter your Gemini API Key">
                <div class="api-note">
                    Get your free API key from <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a>
                </div>
            </div>

            <div class="input-section">
                <div class="input-tabs">
                    <button class="tab-button active" onclick="switchTab('text')">üìù Text News</button>
                    <button class="tab-button" onclick="switchTab('image')">üì∑ Upload Image</button>
                </div>

                <div id="text-tab" class="tab-content active">
                    <div class="textarea-container">
                        <textarea id="newsText" placeholder="Paste the news article, headline, or claim you want to fact-check..."></textarea>
                    </div>
                </div>

                <div id="image-tab" class="tab-content">
                    <div class="file-upload">
                        <input type="file" id="imageInput" class="file-input" accept="image/*">
                        <label for="imageInput" class="file-label">
                            <div class="file-icon">üì∑</div>
                            <div>Click to upload an image</div>
                            <div style="font-size: 14px; color: #666;">Screenshots, memes, or news images</div>
                        </label>
                    </div>
                    <img id="uploadedImage" class="uploaded-image" style="display: none;">
                </div>

                <button id="analyzeBtn" class="analyze-button" onclick="analyzeContent()">
                    Analyze for Misinformation
                </button>
            </div>

            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>Step 1: Generating smart fact-check query...</p>
                <p id="loadingStep">Step 2: Analyzing with real-time data...</p>
                <p style="font-size: 12px; opacity: 0.7;">Using Gemini's current date/time and search capabilities</p>
            </div>

            <div id="results" class="results"></div>
        </div>
    </div>

    <script>
        let currentTab = 'text';
        let uploadedImageData = null;

        function switchTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[onclick="switchTab('${tab}')"]`).classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`${tab}-tab`).classList.add('active');
            
            currentTab = tab;
            clearResults();
        }

        document.getElementById('imageInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedImageData = e.target.result;
                    const img = document.getElementById('uploadedImage');
                    img.src = uploadedImageData;
                    img.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        });

        async function analyzeContent() {
            const apiKey = document.getElementById('geminiApiKey').value.trim();
            if (!apiKey) {
                alert('Please enter your Gemini API key first.');
                return;
            }

            const textContent = document.getElementById('newsText').value.trim();
            
            if (currentTab === 'text' && !textContent) {
                alert('Please enter some news text to analyze.');
                return;
            }
            
            if (currentTab === 'image' && !uploadedImageData) {
                alert('Please upload an image to analyze.');
                return;
            }

            showLoading(true);
            clearResults();

            try {
                let analysisPrompt = '';
                let requestBody = {};

                if (currentTab === 'text') {
                    analysisPrompt = `Analyze the following news text for misinformation, fake news, or misleading information. 

News text: "${textContent}"

Please provide a detailed analysis including:
1. Whether this appears to be REAL, FAKE, or UNCERTAIN
2. Confidence level (0-100%)
3. Specific reasons for your assessment
4. Any red flags or verification suggestions
5. Key facts that can be checked

Format your response clearly with your verdict first.`;

                    requestBody = {
                        contents: [{
                            parts: [{
                                text: analysisPrompt
                            }]
                        }]
                    };
                } else {
                    // For images, extract base64 data
                    const base64Data = uploadedImageData.split(',')[1];
                    const mimeType = uploadedImageData.split(',')[0].split(':')[1].split(';')[0];

                    analysisPrompt = `Analyze this image for potential misinformation, fake news, or misleading content. Look for:

1. Text content in the image - analyze for factual accuracy
2. Visual manipulation signs (deepfakes, photoshop, etc.)
3. Context clues that might indicate false information
4. Whether this appears to be REAL, FAKE, or UNCERTAIN
5. Confidence level (0-100%)
6. Specific reasons for your assessment

Please provide a thorough analysis of what you can observe.`;

                    requestBody = {
                        contents: [{
                            parts: [
                                {
                                    text: analysisPrompt
                                },
                                {
                                    inline_data: {
                                        mime_type: mimeType,
                                        data: base64Data
                                    }
                                }
                            ]
                        }]
                    };
                }

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestBody)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error?.message || 'API request failed');
                }

                const data = await response.json();
                const analysisResult = data.candidates[0].content.parts[0].text;

                // Create a more detailed prompt for final verdict
                const verdictPrompt = `Based on this analysis: "${analysisResult}"

Provide a final structured assessment in this exact format:

VERDICT: [REAL/FAKE/UNCERTAIN]
CONFIDENCE: [0-100]%
SUMMARY: [Brief 2-3 sentence summary of findings]
DETAILS: [Detailed explanation of the reasoning]`;

                const verdictResponse = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: verdictPrompt
                            }]
                        }]
                    })
                });

                const verdictData = await verdictResponse.json();
                const finalResult = verdictData.candidates[0].content.parts[0].text;

                displayResults(finalResult, analysisResult);

            } catch (error) {
                console.error('Error:', error);
                showError(`Analysis failed: ${error.message}`);
            } finally {
                showLoading(false);
            }
        }

        function displayResults(finalResult, fullAnalysis) {
            const resultsDiv = document.getElementById('results');
            
            // Parse the structured result
            const verdictMatch = finalResult.match(/VERDICT:\s*(REAL|FAKE|UNCERTAIN)/i);
            const confidenceMatch = finalResult.match(/CONFIDENCE:\s*(\d+)%/);
            const summaryMatch = finalResult.match(/SUMMARY:\s*(.*?)(?=DETAILS:|$)/s);
            const detailsMatch = finalResult.match(/DETAILS:\s*(.*)/s);

            const verdict = verdictMatch ? verdictMatch[1].toUpperCase() : 'UNCERTAIN';
            const confidence = confidenceMatch ? parseInt(confidenceMatch[1]) : 50;
            const summary = summaryMatch ? summaryMatch[1].trim() : 'Analysis completed';
            const details = detailsMatch ? detailsMatch[1].trim() : fullAnalysis;

            const statusClass = verdict.toLowerCase();
            const statusIcon = verdict === 'REAL' ? '‚úÖ' : verdict === 'FAKE' ? '‚ùå' : '‚ö†Ô∏è';
            const confidenceColor = confidence >= 70 ? '#51cf66' : confidence >= 40 ? '#ffd43b' : '#ff6b6b';

            resultsDiv.innerHTML = `
                <div class="result-card ${statusClass}">
                    <div class="result-header">
                        <span class="status-icon">${statusIcon}</span>
                        <h3>Analysis Result: ${verdict}</h3>
                    </div>
                    
                    <div class="confidence-meter">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>Confidence Level</span>
                            <span>${confidence}%</span>
                        </div>
                        <div class="confidence-bar">
                            <div class="confidence-fill" style="width: ${confidence}%; background-color: ${confidenceColor};"></div>
                        </div>
                    </div>
                    
                    <div class="result-text">
                        <h4>Summary:</h4>
                        <p>${summary}</p>
                        
                        <h4 style="margin-top: 15px;">Detailed Analysis:</h4>
                        <p>${details.replace(/\n/g, '<br>')}</p>
                    </div>
                </div>
            `;
            
            resultsDiv.style.display = 'block';
        }

        function showError(message) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <div class="result-card" style="border-left-color: #ff6b6b;">
                    <div class="result-header">
                        <span class="status-icon" style="color: #ff6b6b;">‚ùå</span>
                        <h3>Error</h3>
                    </div>
                    <div class="result-text">
                        <p>${message}</p>
                    </div>
                </div>
            `;
            resultsDiv.style.display = 'block';
        }

        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
            document.getElementById('analyzeBtn').disabled = show;
        }

        function clearResults() {
            document.getElementById('results').style.display = 'none';
        }
    </script>
</body>
</html>